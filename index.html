<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PAV Luxury Villa</title>

<style>
:root{
--gold:#d4af37;
--bg:#0b0b0d;
--card:#151518;
--green:#29ff8a;
--red:#ff3b3b;
}

*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif;}

body{
background:var(--bg);
color:white;
overflow-x:hidden;
}

/* LOADER */

#loader{
position:fixed;
inset:0;
background:black;
display:flex;
align-items:center;
justify-content:center;
z-index:9999;
transition:1s;
}

#loader.fade{
opacity:0;
pointer-events:none;
}

.paw{
width:140px;
animation:pulse 2s infinite ease-in-out;
}

@keyframes pulse{
0%{transform:scale(1)}
50%{transform:scale(1.08)}
100%{transform:scale(1)}
}

/* SECTIONS */

.section{
display:none;
padding:20px;
animation:fadeIn .4s ease;
}

.section.active{
display:block;
}

@keyframes fadeIn{
from{opacity:0;transform:translateY(10px)}
to{opacity:1;transform:translateY(0)}
}

/* CARDS */

.card{
background:var(--card);
border-radius:20px;
padding:20px;
margin-bottom:20px;
border:1px solid rgba(212,175,55,0.2);
box-shadow:0 0 30px rgba(212,175,55,0.05);
}

.card h2{
color:var(--gold);
margin-bottom:15px;
}

/* BUTTONS */

button{
background:var(--gold);
border:none;
padding:12px 18px;
border-radius:20px;
margin:5px;
cursor:pointer;
font-weight:bold;
}

button:active{
transform:scale(.95);
}

/* TABBAR */

.tabbar{
position:fixed;
bottom:0;
left:0;
right:0;
background:#111;
display:flex;
justify-content:space-around;
padding:10px 0;
border-top:1px solid rgba(255,255,255,.1);
}

.tabbar button{
background:none;
color:white;
font-size:14px;
}

.tabbar button.active{
color:var(--gold);
}

/* CAMERA GRID */

.grid{
display:grid;
grid-template-columns:1fr 1fr;
gap:10px;
}

.camera{
background:black;
border-radius:15px;
overflow:hidden;
position:relative;
}

.camera iframe{
width:100%;
height:160px;
border:none;
}

.camera .status{
position:absolute;
top:8px;
right:8px;
width:10px;
height:10px;
border-radius:50%;
background:var(--green);
}

.camera.fullscreen{
position:fixed;
inset:0;
z-index:999;
background:black;
}

.camera.fullscreen iframe{
height:100%;
}

/* INPUT */

input{
width:100%;
padding:10px;
border-radius:12px;
border:none;
margin-bottom:10px;
background:#222;
color:white;
}

/* PIN MODAL */

#pinModal{
position:fixed;
inset:0;
background:rgba(0,0,0,.9);
display:none;
align-items:center;
justify-content:center;
z-index:9999;
}

.pinBox{
background:#111;
padding:30px;
border-radius:20px;
text-align:center;
}

.pinBox input{
text-align:center;
font-size:22px;
letter-spacing:10px;
}
</style>
</head>

<body>

<!-- LOADER -->
<div id="loader">
<img src="https://i.imgur.com/8Qf4F6S.png" class="paw">
</div>

<!-- PIN MODAL -->
<div id="pinModal">
<div class="pinBox">
<h2>Wprowadź PIN</h2>
<input type="password" id="pinInput" maxlength="4">
<button onclick="verifyPin()">Zatwierdź</button>
</div>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="section active">
<div class="card">
<h2>Alarm</h2>
<p>Status: <span id="alarmStatus" style="color:var(--green)">ROZBROJONY</span></p>
<button onclick="arm()">Uzbrój</button>
<button onclick="requestDisarm()">Rozbrój</button>
</div>

<div class="card">
<h2>Log</h2>
<div id="logs"></div>
<button onclick="exportLogs()">Eksport</button>
</div>
</div>

<!-- CAMERAS -->
<div id="cameras" class="section">
<div class="card">
<h2>Kamery</h2>
<div class="grid" id="cameraGrid"></div>
</div>
</div>

<!-- LIGHTING -->
<div id="lighting" class="section">
<div class="card">
<h2>Oświetlenie (Tasmota)</h2>
<input placeholder="IP urządzenia" id="lightIp">
<button onclick="lightOn()">ON</button>
<button onclick="lightOff()">OFF</button>
<input type="range" min="0" max="100" id="brightness" onchange="setBrightness(this.value)">
</div>
</div>

<!-- TABBAR -->
<div class="tabbar">
<button onclick="switchTab('dashboard')" class="active" id="tab-dashboard">Home</button>
<button onclick="switchTab('cameras')" id="tab-cameras">Kamery</button>
<button onclick="switchTab('lighting')" id="tab-lighting">Światło</button>
</div>

<script>

/* LOADER FIX */
window.addEventListener("load",()=>{
setTimeout(()=>{
document.getElementById("loader").classList.add("fade");
},1500);
});

/* STATE */

let alarmArmed=false;
let logs=JSON.parse(localStorage.getItem("logs"))||[];
let pin=localStorage.getItem("pin")||"1234";
let pendingDisarm=false;

/* LOG */

function addLog(text){
let entry=new Date().toLocaleString()+" - "+text;
logs.unshift(entry);
localStorage.setItem("logs",JSON.stringify(logs));
renderLogs();
}

function renderLogs(){
document.getElementById("logs").innerHTML=
logs.map(l=>"<p>"+l+"</p>").join("");
}
renderLogs();

/* ALARM */

function arm(){
alarmArmed=true;
document.getElementById("alarmStatus").textContent="UZBROJONY";
document.getElementById("alarmStatus").style.color="var(--red)";
addLog("Uzbrojono system");
}

function requestDisarm(){
pendingDisarm=true;
document.getElementById("pinModal").style.display="flex";
}

function verifyPin(){
let val=document.getElementById("pinInput").value;
if(val===pin){
alarmArmed=false;
document.getElementById("alarmStatus").textContent="ROZBROJONY";
document.getElementById("alarmStatus").style.color="var(--green)";
addLog("Rozbrojono system");
document.getElementById("pinModal").style.display="none";
document.getElementById("pinInput").value="";
}else{
alert("Błędny PIN");
}
}

/* CAMERAS */

let cameras=[
"https://www.youtube.com/embed/21X5lGlDOfg",
"https://www.youtube.com/embed/live_stream?channel=UC4R8DWoMoI7CAwX8_LjQHig",
"https://www.youtube.com/embed/5qap5aO4i9A",
"https://www.youtube.com/embed/jfKfPfyJRdk"
];

function loadCameras(){
let grid=document.getElementById("cameraGrid");
grid.innerHTML="";
cameras.forEach(url=>{
let div=document.createElement("div");
div.className="camera";
div.innerHTML="<span class='status'></span><iframe src='"+url+"'></iframe>";
div.onclick=()=>div.classList.toggle("fullscreen");
grid.appendChild(div);
});
}
loadCameras();

/* LIGHTING TASMOTA */

function lightOn(){
let ip=document.getElementById("lightIp").value;
fetch("http://"+ip+"/cm?cmnd=Power%20On");
addLog("Światło ON");
}

function lightOff(){
let ip=document.getElementById("lightIp").value;
fetch("http://"+ip+"/cm?cmnd=Power%20Off");
addLog("Światło OFF");
}

function setBrightness(val){
let ip=document.getElementById("lightIp").value;
fetch("http://"+ip+"/cm?cmnd=Dimmer%20"+val);
addLog("Jasność "+val+"%");
}

/* TAB SWITCH */

function switchTab(id){
document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");

document.querySelectorAll(".tabbar button").forEach(b=>b.classList.remove("active"));
document.getElementById("tab-"+id).classList.add("active");
}

/* EXPORT */

function exportLogs(){
let blob=new Blob([logs.join("\n")],{type:"text/plain"});
let a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="log.txt";
a.click();
}

</script>
</body>
</html>
