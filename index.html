<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PAV Luxury Villa</title>

<style>
:root{
--gold:#d4af37;
--bg:#0b0b0d;
--card:#151518;
--green:#29ff8a;
--red:#ff3b3b;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,sans-serif;}

body{background:var(--bg);color:white;overflow-x:hidden;}

/* LOADER */
#loader{
position:fixed;inset:0;background:black;
display:flex;align-items:center;justify-content:center;
z-index:9999;transition:1s;
}
#loader.fade{opacity:0;pointer-events:none;}

.paw{width:140px;animation:pulse 2s infinite ease-in-out;}
@keyframes pulse{
0%{transform:scale(1)}
50%{transform:scale(1.1)}
100%{transform:scale(1)}
}

/* LOCK */
#lockScreen{
position:fixed;inset:0;background:#000;
display:flex;flex-direction:column;
align-items:center;justify-content:center;
z-index:9998;
}
.pinDisplay{
letter-spacing:15px;font-size:30px;
margin-bottom:20px;color:var(--gold);
}
.keypad{
display:grid;grid-template-columns:repeat(3,70px);
gap:15px;
}
.key{
background:#111;border:1px solid rgba(212,175,55,.3);
border-radius:50%;height:70px;
display:flex;align-items:center;justify-content:center;
font-size:22px;cursor:pointer;
}
.key:active{background:var(--gold);color:black;}

/* SECTIONS */
.section{display:none;padding:20px;}
.section.active{display:block;}

/* CARD */
.card{
background:var(--card);
border-radius:20px;
padding:20px;margin-bottom:20px;
border:1px solid rgba(212,175,55,0.2);
}
.card h2{color:var(--gold);margin-bottom:15px;}

button{
background:var(--gold);
border:none;padding:10px 15px;
border-radius:15px;
cursor:pointer;font-weight:bold;
margin-top:5px;
}

/* TABBAR */
.tabbar{
position:fixed;bottom:0;left:0;right:0;
background:#111;display:flex;
justify-content:space-around;
padding:10px 0;
border-top:1px solid rgba(255,255,255,.1);
}
.tabbar button{background:none;color:white;}
.tabbar button.active{color:var(--gold);}
</style>
</head>
<body>

<div id="loader">
<img src="https://i.imgur.com/8Qf4F6S.png" class="paw">
</div>

<div id="lockScreen">
<div class="pinDisplay" id="pinDots">----</div>
<div class="keypad" id="keypad"></div>
</div>

<div id="home" class="section active">
<div class="card">
<h2>Alarm</h2>
<p>Status: <span id="alarmStatus" style="color:var(--green)">ROZBROJONY</span></p>
<button onclick="arm()">Uzbrój</button>
<button onclick="requestDisarm()">Rozbrój</button>
</div>
</div>

<div id="settings" class="section">
<div class="card">
<h2>Zmień PIN</h2>
<input type="password" id="oldPin" placeholder="Stary PIN">
<input type="password" id="newPin" placeholder="Nowy PIN (4 cyfry)">
<button onclick="changePin()">Zmień PIN</button>
</div>
</div>

<div class="tabbar">
<button onclick="switchTab('home', this)" class="active">Home</button>
<button onclick="switchTab('settings', this)">Ustawienia</button>
</div>

<script>

/* LOADER */
window.addEventListener("load",()=>{
setTimeout(()=>{
document.getElementById("loader").classList.add("fade");
},1200);
});

/* PIN SYSTEM */
let entered="";
let attempts=0;
let lockedUntil=0;
let currentPin=localStorage.getItem("pin")||"1234";

function renderKeypad(){
for(let i=1;i<=9;i++) createKey(i);
createKey("C");
createKey(0);
createKey("OK");
}

function createKey(val){
let d=document.createElement("div");
d.className="key";
d.textContent=val;
d.onclick=function(){ pressKey(val); };
document.getElementById("keypad").appendChild(d);
}

function pressKey(val){
if(Date.now()<lockedUntil)return;

if(val==="C"){
entered="";
}else if(val==="OK"){
checkPin();
}else if(entered.length<4){
entered+=val;
}

updateDots();
}

function updateDots(){
document.getElementById("pinDots").textContent =
entered.padEnd(4,"-");
}

function checkPin(){
if(entered===currentPin){
document.getElementById("lockScreen").style.display="none";
}else{
attempts++;
if(attempts>=3){
lockedUntil=Date.now()+60000;
alert("Blokada 60 sekund");
}
}
entered="";
updateDots();
}

renderKeypad();

/* CHANGE PIN */
function changePin(){
let old=document.getElementById("oldPin").value;
let nw=document.getElementById("newPin").value;
let stored=localStorage.getItem("pin")||"1234";

if(old!==stored){
alert("Zły stary PIN");
return;
}
if(nw.length!==4 || isNaN(nw)){
alert("PIN musi mieć 4 cyfry");
return;
}

localStorage.setItem("pin",nw);
currentPin=nw;
alert("PIN zmieniony");

document.getElementById("oldPin").value="";
document.getElementById("newPin").value="";
}

/* ALARM */
function arm(){
document.getElementById("alarmStatus").textContent="UZBROJONY";
document.getElementById("alarmStatus").style.color="var(--red)";
}
function requestDisarm(){
entered="";
updateDots();
document.getElementById("lockScreen").style.display="flex";
}

/* TAB FIX */
function switchTab(id, btn){
document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");

document.querySelectorAll(".tabbar button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
}

</script>
</body>
</html>
