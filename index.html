<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PAV+ 3.6</title>

<link rel="manifest" href="manifest.json">
<link rel="icon" href="IMG_5759.png">
<link rel="apple-touch-icon" href="IMG_5759.png">
<meta name="theme-color" content="#d4af37">

<style>
:root{
--gold:#d4af37;
--bg:#0b0b0d;
--card:rgba(255,255,255,0.05);
--border:rgba(212,175,55,0.3);
--red:#ff3b3b;
--green:#29ff8a;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,sans-serif;}
body{background:var(--bg);color:white;overflow:hidden;}

/* SPLASH */
#splash{position:fixed;inset:0;background:black;display:flex;align-items:center;justify-content:center;z-index:3000;transition:opacity 1s;}
#splash.fade{opacity:0;pointer-events:none;}
.paw{font-size:40px;color:var(--gold);animation:glow 2s infinite;}
@keyframes glow{0%{text-shadow:0 0 5px var(--gold);}50%{text-shadow:0 0 25px var(--gold);}100%{text-shadow:0 0 5px var(--gold);}}

/* LOCK */
#lock{position:fixed;inset:0;background:black;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:2000;}
.display{font-size:32px;letter-spacing:15px;margin-bottom:20px;color:var(--gold);}
.keypad{display:grid;grid-template-columns:repeat(3,80px);gap:15px;}
.key{height:80px;width:80px;border-radius:50%;background:#111;border:1px solid var(--gold);display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;}
.key:active{background:var(--gold);color:black;}

#app{display:none;height:100vh;overflow:hidden;}

.section{
position:absolute;top:0;left:0;right:0;bottom:70px;
display:flex;justify-content:center;padding:20px;
overflow:auto;opacity:0;transform:translateX(20px);
transition:.35s ease;pointer-events:none;
}
.section.active{opacity:1;transform:translateX(0);pointer-events:auto;}

.container{width:100%;max-width:500px;}

.card{
background:var(--card);
backdrop-filter:blur(12px);
padding:20px;border-radius:15px;
border:1px solid var(--border);
margin-bottom:20px;text-align:center;
}

h3{margin-bottom:15px;color:var(--gold);}

input{
width:100%;padding:10px;margin-top:10px;
border-radius:8px;border:none;
background:#111;color:white;text-align:center;
}

button{
margin-top:10px;padding:8px 14px;
border:none;border-radius:8px;
background:var(--gold);color:black;
font-weight:bold;cursor:pointer;
}

/* TABBAR */
.tabbar{
position:fixed;bottom:0;left:0;right:0;
height:70px;background:#111;
display:flex;justify-content:space-around;
align-items:center;border-top:1px solid rgba(255,255,255,.1);
}
.tab{flex:1;text-align:center;color:#888;font-size:12px;cursor:pointer;transition:.3s;}
.tab.active{color:var(--gold);transform:translateY(-5px);}
.tab span{display:block;font-size:20px;}
.tab.active span{text-shadow:0 0 10px var(--gold);}

/* ALARM */
.alarm.armed{animation:redPulse 1.5s infinite;border-color:var(--red);}
@keyframes redPulse{
0%{box-shadow:0 0 5px var(--red);}
50%{box-shadow:0 0 25px var(--red);}
100%{box-shadow:0 0 5px var(--red);}
}

/* CAMERAS */
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.camera{background:black;border-radius:10px;overflow:hidden;position:relative;}
.camera iframe{width:100%;height:150px;border:none;}
.remove{
position:absolute;top:6px;right:6px;
background:rgba(0,0,0,.7);
border:none;color:white;border-radius:50%;
width:22px;height:22px;cursor:pointer;
}
.camera.fullscreen{
position:fixed;inset:0;z-index:4000;
background:black;display:flex;
align-items:center;justify-content:center;
}
.camera.fullscreen iframe{
width:90%;height:90%;
border-radius:12px;
}

.statusDot{
position:absolute;top:8px;left:8px;
width:12px;height:12px;border-radius:50%;
background:gray;
}
.statusDot.online{background:var(--green);}
.statusDot.offline{background:var(--red);}

/* LOG */
.log{
font-size:12px;max-height:200px;
overflow:auto;background:#111;
padding:10px;border-radius:8px;text-align:left;
}
</style>
</head>
<body>

<div id="splash"><div class="paw">ðŸ¦š PAV+</div></div>

<div id="lock">
<div class="display" id="display">----</div>
<div class="keypad" id="keys"></div>
</div>

<div id="app">

<!-- ALARM -->
<div class="section active" id="alarmSection">
<div class="container">
<div class="card alarm" id="alarmCard">
<h3>Alarm</h3>

<input id="alarmAddress" placeholder="Adres alarmu">
<button onclick="saveAlarm()">Zapisz adres</button>

<input type="time" id="scheduleTime">
<button onclick="saveSchedule()">Zapisz godzinÄ™</button>
<button id="toggleScheduleBtn" onclick="toggleSchedule()">Harmonogram: OFF</button>

<button onclick="arm()">UzbrÃ³j</button>
<button onclick="disarm()">RozbrÃ³j</button>

<div id="mainCameraBox" style="margin-top:15px;"></div>

</div>
</div>
</div>

<!-- LIGHT -->
<div class="section" id="lightSection">
<div class="container">
<div class="card">
<h3>OÅ›wietlenie</h3>
<input id="lightAddress" placeholder="Adres oÅ›wietlenia">
<button onclick="saveLight()">Zapisz adres</button>
</div>
</div>
</div>

<!-- CAMERAS -->
<div class="section" id="camSection">
<div class="container">
<div class="card">
<h3>Kamery (6)</h3>
<input id="camInput" placeholder="Adres embed">
<button onclick="addCam()">Dodaj</button>
<div class="grid" id="camGrid"></div>
</div>
</div>
</div>

<!-- LOG -->
<div class="section" id="logSection">
<div class="container">
<div class="card">
<h3>Log</h3>
<div class="log" id="logBox"></div>
</div>
</div>
</div>

<div class="tabbar">
<div class="tab active" onclick="switchTab('alarmSection',this)"><span>ðŸš¨</span>Alarm</div>
<div class="tab" onclick="switchTab('lightSection',this)"><span>ðŸ’¡</span>ÅšwiatÅ‚o</div>
<div class="tab" onclick="switchTab('camSection',this)"><span>ðŸŽ¥</span>Kamery</div>
<div class="tab" onclick="switchTab('logSection',this)"><span>ðŸ“œ</span>Log</div>
</div>

</div>

<script>

/* SPLASH */
setTimeout(()=>splash.classList.add("fade"),1500);

/* PIN */
const PIN="1111";
let input="";
function update(){display.innerText=input.padEnd(4,"-");}
function press(v){
if(v==="C"){input="";}
else if(v==="OK"){if(input===PIN){unlock();}input="";}
else if(input.length<4){input+=v;}
update();
}
function unlock(){lock.style.display="none";app.style.display="block";loadSavedData();}
for(let i=1;i<=9;i++)create(i);
create("C");create(0);create("OK");
function create(v){let d=document.createElement("div");d.className="key";d.innerText=v;d.onclick=()=>press(v);keys.appendChild(d);}
update();

/* TABS */
function switchTab(id,el){
document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
el.classList.add("active");
}

/* LOG */
function log(txt){
let logs=JSON.parse(localStorage.getItem("logs"))||[];
logs.unshift(new Date().toLocaleTimeString()+" - "+txt);
localStorage.setItem("logs",JSON.stringify(logs));
renderLog();
}
function renderLog(){
let logs=JSON.parse(localStorage.getItem("logs"))||[];
logBox.innerHTML=logs.slice(0,40).join("<br>");
}
renderLog();

/* ALARM */
let armed=false;
function saveAlarm(){localStorage.setItem("alarmAddress",alarmAddress.value);log("Zapisano adres alarmu");}
function arm(auto=false){armed=true;alarmCard.classList.add("armed");log(auto?"Auto uzbrojenie":"Alarm uzbrojony");}
function disarm(){armed=false;alarmCard.classList.remove("armed");log("Alarm rozbrojony");}

/* HARMONOGRAM */
let scheduleEnabled=localStorage.getItem("scheduleEnabled")==="true";
function saveSchedule(){localStorage.setItem("scheduleTime",scheduleTime.value);log("Ustawiono harmonogram");}
function toggleSchedule(){
scheduleEnabled=!scheduleEnabled;
localStorage.setItem("scheduleEnabled",scheduleEnabled);
toggleScheduleBtn.innerText="Harmonogram: "+(scheduleEnabled?"ON":"OFF");
}
function checkSchedule(){
if(!scheduleEnabled)return;
let t=localStorage.getItem("scheduleTime");
if(!t)return;
let now=new Date();
let current=now.getHours().toString().padStart(2,"0")+":"+now.getMinutes().toString().padStart(2,"0");
if(current===t && !armed){arm(true);}
}
setInterval(checkSchedule,60000);

/* LIGHT */
function saveLight(){localStorage.setItem("lightAddress",lightAddress.value);log("Zapisano adres oÅ›wietlenia");}

/* LOAD */
function loadSavedData(){
alarmAddress.value=localStorage.getItem("alarmAddress")||"";
lightAddress.value=localStorage.getItem("lightAddress")||"";
scheduleTime.value=localStorage.getItem("scheduleTime")||"";
toggleScheduleBtn.innerText="Harmonogram: "+(scheduleEnabled?"ON":"OFF");
}

/* CAMERAS */
let cams=JSON.parse(localStorage.getItem("cams"))||[];
function renderCams(){
camGrid.innerHTML="";
for(let i=0;i<6;i++){
let url=cams[i]||"";
let div=document.createElement("div");
div.className="camera";
if(url){
div.innerHTML=`<button class="remove" onclick="event.stopPropagation();removeCam(${i})">Ã—</button><iframe src="${url}"></iframe>`;
div.onclick=()=>div.classList.toggle("fullscreen");
}else{
div.innerHTML="<div style='height:150px;display:flex;align-items:center;justify-content:center;opacity:.4;'>Brak</div>";
}
camGrid.appendChild(div);
}
renderMainCamera();
}
function renderMainCamera(){
if(cams.length>0){
mainCameraBox.innerHTML=`<iframe src="${cams[0]}" style="width:100%;height:180px;border:none;border-radius:12px;"></iframe>`;
}else{
mainCameraBox.innerHTML="<div style='opacity:.4;'>Brak gÅ‚Ã³wnej kamery</div>";
}
}
function addCam(){
if(cams.length>=6){alert("Max 6 kamer");return;}
let url=camInput.value;if(!url)return;
cams.push(url);
localStorage.setItem("cams",JSON.stringify(cams));
camInput.value="";
renderCams();
log("Dodano kamerÄ™");
}
function removeCam(i){
cams.splice(i,1);
localStorage.setItem("cams",JSON.stringify(cams));
renderCams();
log("UsuniÄ™to kamerÄ™");
}
renderCams();

/* PWA */
if ("serviceWorker" in navigator) {
window.addEventListener("load", function() {
navigator.serviceWorker.register("sw.js");
});
}
</script>

</body>
</html>
